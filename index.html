<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>  مـوقـع مـدربـيـن الـورش</title>

<style>
  :root{
    --bg-img: url('picture.png');
    --overlay: rgba(0,0,0,0.46);
    --card-bg-dark: #1a1a1c;
    --card-border: rgba(255,255,255,0.06);
    --accent: #ffd23f;
    --accent-2: #f3bd1f;
    --muted: rgba(255,255,255,0.72);
    --glass: rgba(255,255,255,0.05);
    --shadow: 0 14px 40px rgba(0,0,0,0.6);
  }

  html,body{height:100%}
  body{
    margin:0;
    font-family:"Segoe UI",Tahoma,Arial,sans-serif;
    background-image:var(--bg-img);
    background-size:cover;
    background-position:center;
    background-attachment:fixed;
    color:#fff;
  }

  .overlay{ position:fixed; inset:0; background:var(--overlay); z-index:0; }

  .app{ position:relative; z-index:1; max-width:1100px; margin:28px auto; padding:22px; }

  .side-button{
    position:fixed; right:8px; top:50%; transform:translateY(-50%);
    width:56px; height:56px; border-radius:12px;
    background:linear-gradient(180deg,var(--accent),var(--accent-2));
    border:none; cursor:pointer; display:flex; align-items:center; justify-content:center;
    box-shadow:var(--shadow); z-index:9999;
  }
  .side-button .lines{ width:22px; height:16px; position:relative; }
  .side-button .lines span{ position:absolute; left:0; right:0; height:2px; background:#111; border-radius:2px; }
  .side-button .lines span:nth-child(1){ top:0 } .side-button .lines span:nth-child(2){ top:7px } .side-button .lines span:nth-child(3){ top:14px }

  .menu{
    position:fixed; right:76px; top:50%; transform:translateY(-50%) translateX(8px);
    width:360px; max-width:calc(100vw - 120px);
    background:rgba(10,10,12,0.95); border:1px solid var(--card-border); border-radius:14px; padding:12px;
    opacity:0; pointer-events:none; transition:0.2s ease; z-index:9999;
  }
  .menu.open{ opacity:1; pointer-events:auto; transform:translateY(-50%) translateX(0); }

  .menu-section{ padding:6px; border-radius:10px; }
  .menu-title{ display:flex; justify-content:space-between; font-weight:900; color:var(--accent); font-size:13px; }
  .menu-list{ display:flex; flex-direction:column; gap:8px; margin-top:6px; }
  .menu-item{ display:flex; justify-content:space-between; padding:10px; border-radius:10px; background:rgba(255,255,255,0.02); cursor:pointer; border:1px solid transparent; transition:0.15s; align-items:center; gap:8px; }
  .menu-item:hover{ background:rgba(255,255,255,0.05); border-color:rgba(255,255,255,0.1); }
  .menu-item a{ color:#fff; text-decoration:none; font-weight:800; flex:1; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
  .menu-copy{ background:transparent; border:1px solid rgba(255,255,255,0.1); color:var(--muted); padding:6px 8px; border-radius:8px; cursor:pointer; font-weight:800; }

  .menu-divider{ height:1px; background:rgba(255,255,255,0.1); margin:10px 0; }

  .intro{ position:fixed; inset:0; background:rgba(0,0,0,0.6); display:flex; align-items:center; justify-content:center; z-index:9998; }
  .intro-card{ width:min(720px,95%); background:#1a1a1c; border:1px solid var(--card-border); border-radius:14px; padding:20px; text-align:center; box-shadow:var(--shadow); }
  .choice-btn{ background:linear-gradient(180deg,var(--accent),var(--accent-2)); color:#111; border:0; padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:900; min-width:140px; }
  .choice-ghost{ background:transparent; border:1px solid rgba(255,255,255,0.2); color:#fff; padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:800; }

  .type-switch{ background:#000; border:1px solid rgba(255,255,255,0.1); padding:8px 10px; border-radius:10px; display:flex; align-items:center; gap:8px; }
  .type-switch label{ color:#fff; font-weight:800; }
  .type-select{ background:#000; color:#fff; border:1px solid rgba(255,255,255,0.12); padding:8px 10px; border-radius:8px; font-weight:800; }

  .card{ background:#1a1a1c; border:1px solid rgba(255,255,255,0.06); border-radius:14px; padding:18px; box-shadow:var(--shadow); margin-bottom:20px; }
  label{ font-weight:800; margin-bottom:6px; display:block; color:#fff; }
  input, select, textarea{ width:100%; padding:10px; border-radius:10px; border:1px solid rgba(255,255,255,0.1); background:rgba(255,255,255,0.03); color:#fff; box-sizing:border-box; }
  textarea{ min-height:140px; }

  .input-gray{
    background:#2b2b2b;
    color:#fff;
    border:1px solid rgba(255,255,255,0.06);
    padding:10px;
    border-radius:10px;
    width:100%;
    box-sizing:border-box;
  }

  .select-dark{
    background:#2b2b2b;
    color:#fff;
    border:1px solid rgba(255,255,255,0.12);
    padding:10px;
    border-radius:8px;
    width:100%;
    box-sizing:border-box;
  }

  .btn{ background:linear-gradient(180deg,var(--accent),var(--accent-2)); color:#111; border:0; padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:900; }
  .btn-ghost{ background:transparent; border:1px solid rgba(255,255,255,0.2); color:#fff; padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:800; }

  #basicCard .row{ display:block; gap:0; }
  #basicCard .row > div{ margin-bottom:12px; }

  .actions{ display:flex; gap:10px; flex-wrap:wrap; }
  .grade-label{ font-weight:900; color:var(--accent); margin-bottom:6px; }
</style>
</head>

<body>
<div class="overlay"></div>

<div id="intro" class="intro">
  <div class="intro-card">
    <h2>اختر نوع النموذج للبدء</h2>
    <p>يمكنك تغيير النوع لاحقاً من داخل الموقع</p>

    <div style="display:flex; gap:12px; justify-content:center; flex-wrap:wrap;">
      <button class="choice-btn" data-select="basic">دورة أساسية</button>
      <button class="choice-btn" data-select="special">دورة استثنائية</button>
      <button class="choice-btn" data-select="results">النتائج</button>
    </div>

    <div style="margin-top:14px;">
      <button id="introClose" class="choice-ghost">إغلاق</button>
    </div>
  </div>
</div>

<button id="sideBtn" class="side-button" title="قائمة الروابط">
  <span class="lines"><span></span><span></span><span></span></span>
</button>

<div id="menu" class="menu" aria-hidden="true">
  <div class="menu-section">
    <div class="menu-title"><span>الشروحات</span></div>
    <div class="menu-list">
      <div class="menu-item"><a href="https://www.canva.com/design/DAGs6ZpXJZ4/8EczNf7jWa4grGNC1_JREQ/view" target="_blank" rel="noopener">شرح العمليات</a><button class="menu-copy" data-url="https://www.canva.com/design/DAGs6ZpXJZ4/8EczNf7jWa4grGNC1_JREQ/view">نسخ</button></div>
      <div class="menu-item"><a href="https://www.canva.com/design/DAGutzHb2cc/ZLwcKlEfX4nu087DKCm6Rg/view" target="_blank" rel="noopener">شرح خدمات الطرق</a><button class="menu-copy" data-url="https://www.canva.com/design/DAGutzHb2cc/ZLwcKlEfX4nu087DKCm6Rg/view">نسخ</button></div>
      <div class="menu-item"><a href="https://www.canva.com/design/DAGsZ5eHaC0/RbIkYJ-3c14h-uQPWNa7qw/view" target="_blank" rel="noopener">شرح ورشة التصنيع</a><button class="menu-copy" data-url="https://www.canva.com/design/DAGsZ5eHaC0/RbIkYJ-3c14h-uQPWNa7qw/view">نسخ</button></div>
      <div class="menu-item"><a href="https://www.canva.com/design/DAGs6S2N9oQ/yOKZcDlmq_uPsFzL-ZvZwg/view" target="_blank" rel="noopener">شرح ورشة التزويد</a><button class="menu-copy" data-url="https://www.canva.com/design/DAGs6S2N9oQ/yOKZcDlmq_uPsFzL-ZvZwg/view">نسخ</button></div>
      <div class="menu-item"><a href="https://www.canva.com/design/DAGvSVLyjNc/FF6lXkGowebTEMz84JUhWQ/view" target="_blank" rel="noopener">شرح البحث والإنقاذ</a><button class="menu-copy" data-url="https://www.canva.com/design/DAGvSVLyjNc/FF6lXkGowebTEMz84JUhWQ/view">نسخ</button></div>
      <div class="menu-item"><a href="https://www.canva.com/design/DAGtKZe7JW8/hgWzX9YAkCUTxIm3-m0mMw/view" target="_blank" rel="noopener">شرح الدليل الشامل</a><button class="menu-copy" data-url="https://www.canva.com/design/DAGtKZe7JW8/hgWzX9YAkCUTxIm3-m0mMw/view">نسخ</button></div>
    </div>
  </div>

  <div class="menu-divider"></div>

  <div class="menu-section">
    <div class="menu-title"><span>الاختبارات</span></div>
    <div class="menu-list">
      <div class="menu-item"><a href="https://docs.google.com/forms/d/e/1FAIpQLSeusy4R53UNc5tTKKEIi8KE_zXxMRJxkJm5CSw8WcYuZU2kCw/viewform?usp=dialog" target="_blank" rel="noopener">اختبار دورة العمليات</a><button class="menu-copy" data-url="https://docs.google.com/forms/d/e/1FAIpQLSeusy4R53UNc5tTKKEIi8KE_zXxMRJxkJm5CSw8WcYuZU2kCw/viewform?usp=dialog">نسخ</button></div>
      <div class="menu-item"><a href="https://docs.google.com/forms/d/1sOiQ93J2q5lgzm7m5bVkYb3lKjHr7nCU5cx6fQEaICY/edit" target="_blank" rel="noopener">اختبار ورشة التصنيع</a><button class="menu-copy" data-url="https://docs.google.com/forms/d/1sOiQ93J2q5lgzm7m5bVkYb3lKjHr7nCU5cx6fQEaICY/edit">نسخ</button></div>
      <div class="menu-item"><a href="https://docs.google.com/forms/d/e/1FAIpQLSdXFnId2b-MxfdLr8oebJnQTbdjI-SN4L6Y1gXBNjJiPbGn1A/viewform?usp=dialog" target="_blank" rel="noopener">اختبار خدمات الطرق</a><button class="menu-copy" data-url="https://docs.google.com/forms/d/e/1FAIpQLSdXFnId2b-MxfdLr8oebJnQTbdjI-SN4L6Y1gXBNjJiPbGn1A/viewform?usp=dialog">نسخ</button></div>
      <div class="menu-item"><a href="https://docs.google.com/forms/d/e/1FAIpQLSdXpfhNYO5qdkb3d0v_NkwOeKRUTjNxYWW9ptllPWswXmnqFg/viewform?usp=dialog" target="_blank" rel="noopener">اختبار التعديل والتزويد</a><button class="menu-copy" data-url="https://docs.google.com/forms/d/e/1FAIpQLSdXpfhNYO5qdkb3d0v_NkwOeKRUTjNxYWW9ptllPWswXmnqFg/viewform?usp=dialog">نسخ</button></div>
      <div class="menu-item"><a href="https://docs.google.com/forms/d/e/1FAIpQLSd66idu5DuEGXjd1xFS0JFnuEto9LUi6V24q47hwctUC0Lrug/viewform" target="_blank" rel="noopener">اختبار البحث والإنقاذ</a><button class="menu-copy" data-url="https://docs.google.com/forms/d/e/1FAIpQLSd66idu5DuEGXjd1xFS0JFnuEto9LUi6V24q47hwctUC0Lrug/viewform">نسخ</button></div>
    </div>
  </div>

  <div class="menu-divider"></div>

  <div class="menu-section">
    <div class="menu-title"><span>روابط إضافية</span></div>
    <div class="menu-list">
      <div class="menu-item"><a href="https://xhhp1.github.io/MechanicAF/" target="_blank" rel="noopener">موقع الشوؤن الادارية</a><button class="menu-copy" data-url="https://xhhp1.github.io/MechanicAF/">نسخ</button></div>
      <div class="menu-item"><a href="https://docs.google.com/spreadsheets/d/1K79WxPJarDhtjEscZDwjPojcYYbvWkDUMK_HXMMdJGE/edit?gid=1734254035#gid=1734254035" target="_blank" rel="noopener">موقع مدربين الورش</a><button class="menu-copy" data-url="https://docs.google.com/spreadsheets/d/1K79WxPJarDhtjEscZDwjPojcYYbvWkDUMK_HXMMdJGE/edit?gid=1734254035#gid=1734254035">نسخ</button></div>
    </div>
  </div>
</div>

<div class="app">
  <div class="header" style="display:flex; justify-content:space-between; align-items:center;">
    <h2>نماذج الدورات</h2>

    <div class="type-switch">
      <label>نوع النموذج</label>
      <select id="typeSelect" class="type-select select-dark">
        <option value="none">-- اختر --</option>
        <option value="basic">أساسية</option>
        <option value="special">استثنائية</option>
        <option value="results">النتائج</option>
      </select>
    </div>
  </div>

  <!-- بطاقة الدورة الأساسية -->
  <section id="basicCard" class="card" style="display:none;">
    <h3>نموذج الانتهاء من الدورة (أساسية)</h3>

    <div class="row">
      <div>
        <label>رقم التسلسل من جدول الرسوم</label>
        <input id="sequenceBasic" class="input-gray" type="number" placeholder="مثال: 5">
      </div>

      <div>
        <label>اسم الدورة</label>
        <select id="courseNameBasic" class="select-dark">
          <option value="">-- اختر --</option>
          <option>الدليل الشامل</option>
          <option>العمليات</option>
          <option>ورشة التصنيع</option>
          <option>خدمات الطرق</option>
          <option>ورشة التزويد</option>
          <option>دورة مدربين الورش</option>
          <option>دورة الشوؤن الأدارية</option>
          <option>شوؤن توظيف الكراج</option>
          <option>البحث والإنقاذ</option>
        </select>
      </div>
    </div>

    <div class="row">
      <div>
        <label>رقم الدورة</label>
        <input id="numBasic" class="input-gray" type="text" placeholder="مثال: 7">
      </div>

      <div>
        <label>رابط النتائج</label>
        <input id="urlBasic" class="input-gray" type="text" placeholder="ضع رابط النتائج هنا">
      </div>
    </div>

    <div class="row">
      <div>
        <label>تم شرح الدورة من قبل</label>
        <input id="explBasic" class="input-gray" type="text" placeholder="ضع الكوبي ايدي للمدرب شارح الدورة       ">
      </div>

      <div>
        <label>تم تصحيح الاختبار من قبل</label>
        <input id="corrBasic" class="input-gray" type="text" placeholder="ضع الكوبي ايدي لمصحح الاختبار          ">
      </div>
    </div>

    <div class="row">
      <div>
        <label>المدربين متفاعلين</label>
        <input id="trainersBasic" class="input-gray" type="text" placeholder="ضع الكوبي ايدي للمدربين المتفاعلين مفصولة بمسافة في حال وجود اكثر من مدرب">
      </div>

      <div>
        <label>باقي المدربين</label>
        <input id="othersBasic" class="input-gray" type="text" placeholder="ضع الكوبي ايدي لباقي المدربين مفصولة بمسافة في حال وجود اكثر من مدرب">
      </div>
    </div>

    <div class="actions" style="margin-top:14px;">
      <button id="createBasic" class="btn">إنشاء</button>
      <button id="copyBasic" class="btn-ghost">نسخ</button>
    </div>

    <div class="sep" style="height:1px; background:rgba(255,255,255,0.06); margin:14px 0;"></div>
    <textarea id="outputBasic" readonly></textarea>
  </section>

  <!-- بطاقة الدورة الاستثنائية -->
  <section id="specialCard" class="card" style="display:none;">
    <h3>نموذج الانتهاء من الدورة (استثنائية)</h3>

    <div class="row" style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
      <div>
        <label>رقم التسلسل من جدول الرسوم</label>
        <input id="sequenceSpecial" type="number" placeholder="مثال: 7" class="input-gray">
      </div>

      <div>
        <label>اسم الدورة</label>
        <select id="courseNameSpecial" class="select-dark">
          <option value="">-- اختر --</option>
          <option>الدليل الشامل</option>
          <option>العمليات</option>
          <option>ورشة التصنيع</option>
          <option>خدمات الطرق</option>
          <option>ورشة التزويد</option>
          <option>دورة مدربين الورش</option>
          <option>دورة الشوؤن الأدارية</option>
          <option>شوؤن توظيف الكراج</option>
          <option>البحث والإنقاذ</option>
        </select>
      </div>
    </div>

    <div style="margin-top:12px;">
      <label>تم إقامة الدورة للفني</label>
      <input id="techSpecial" class="input-gray" type="text" placeholder="ضع الكوبي ايدي للفني">
    </div>

    <div style="margin-top:12px;">
      <label>تم شرح الدورة من قبل المدرب</label>
      <input id="explSpecial" class="input-gray" type="text" placeholder="ضع الكوبي ايدي للمدرب شارح الدورة  ">
    </div>

    <div style="margin-top:12px;">
      <label>درجة الاختبار (اختياري)</label>
      <select id="gradeSpecial" class="select-dark">
        <option value="">-- اختر درجة --</option>
        <option>10 / 10</option>
        <option>10 / 09</option>
        <option>10 / 08</option>
        <option>10 / 07</option>
        <option>لايوجد</option>
      </select>
    </div>

    <div class="actions" style="margin-top:14px;">
      <button id="createSpecial" class="btn">إنشاء</button>
      <button id="copySpecial" class="btn-ghost">نسخ</button>
    </div>

    <div class="sep" style="height:1px; background:rgba(255,255,255,0.06); margin:14px 0;"></div>
    <textarea id="outputSpecial" readonly></textarea>
  </section>

  <!-- بطاقة النتائج -->
  <section id="resultsCard" class="card" style="display:none;">
    <h3>نموذج النتائج</h3>

    <div style="margin-top:8px;">
      <label>اسم الدورة</label>
      <select id="courseNameResults" class="select-dark">
        <option value="">-- اختر --</option>
        <option>الدليل الشامل</option>
        <option>العمليات</option>
        <option>ورشة التصنيع</option>
        <option>خدمات الطرق</option>
        <option>ورشة التزويد</option>
        <option>دورة مدربين الورش</option>
        <option>دورة الشوؤن الأدارية</option>
        <option>شوؤن توظيف الكراج</option>
        <option>البحث والإنقاذ</option>
      </select>

      <label style="margin-top:10px;">رقم الدورة</label>
      <input id="resultsNum" class="input-gray" type="text" placeholder="مثال: 7   ">
    </div>

    <div class="grades" style="margin-top:12px;">
      <div style="margin-top:8px;">
        <div class="grade-label">***10 / 10***</div>
        <input id="grade10" class="select-dark" type="text" placeholder="مثال: 1069596605080162397 893986969456111617  أو اكتب: لايوجد">
      </div>
      <div style="margin-top:8px;">
        <div class="grade-label">***10 / 09***</div>
        <input id="grade9" class="select-dark" type="text" placeholder="مثال:  893986969456111617 1069596605080162397  أو اكتب: لايوجد">
      </div>
      <div style="margin-top:8px;">
        <div class="grade-label">***10 / 08***</div>
        <input id="grade8" class="select-dark" type="text" placeholder="مثال: 893986969456111617 1069596605080162397  أو اكتب: لايوجد">
      </div>
      <div style="margin-top:8px;">
        <div class="grade-label">***10 / 07***</div>
        <input id="grade7" class="select-dark" type="text" placeholder="مثال:  893986969456111617 أو اكتب: لايوجد">
      </div>
    </div>

    <div style="margin-top:12px;">
      <label>شارح الدورة</label>
      <input id="resultsExplainer" class="select-dark" type="text" placeholder="ضع الكوبي ايدي لشارح الدورة">

      <label style="margin-top:8px;">مسؤول الدورة</label>
      <input id="resultsResponsible" class="select-dark" type="text" placeholder="ضع الكوبي ايدي لمسوؤل الدورة ">

      <label style="margin-top:8px;">نائب مسؤول الدورة</label>
      <input id="resultsDeputy" class="select-dark" type="text" placeholder="ضع الكوبي ايدي لنائب مسوؤل الدورة (في حال وجود اكثر من مسوؤل ضع الكوبي ايدي مفصول بمسافة) ">
    </div>

    <div class="actions" style="margin-top:14px;">
      <button id="createResults" class="btn">إنشاء النتائج</button>
      <button id="copyResults" class="btn-ghost">نسخ</button>
    </div>

    <div class="sep" style="height:1px; background:rgba(255,255,255,0.06); margin:14px 0;"></div>
    <textarea id="outputResults" readonly></textarea>
  </section>
</div>

<script>
  const sigMap = {
    "الدليل الشامل":"<@1271182726179061915>",
    "العمليات":"<@1240550089093677087>",
    "ورشة التصنيع":"<@508028428830638085>",
    "خدمات الطرق":"<@1059976190988910772>",
    "ورشة التزويد":"<@571068478753341453>",
    "دورة مدربين الورش":"<@1243196849372790916>",
    "دورة الشوؤن الأدارية":"<@1059976190988910772>",
    "شوؤن توظيف الكراج":"<@1271182726179061915>",
    "البحث والإنقاذ":"<@1243196849372790916>"
  };

  function normalizeToMentions(input){
    if(input === null || input === undefined) return '( - )';
    const raw = input.toString().trim();
    if(raw.length === 0) return '( - )';
    if(raw.toLowerCase() === 'لايوجد') return 'لايوجد';
    const parts = raw.split(/\s+/);
    const out = parts.map(part => {
      if(/^<@[^>]+>$/.test(part)) return part;
      if(/^@(.+)$/.test(part)){
        const id = part.replace(/^@/, '');
        return `<@${id}>`;
      }
      if(/^[\dA-Za-z_-]+$/.test(part)){
        return `<@${part}>`;
      }
      return part;
    });
    return out.join(' ');
  }

  function generateBasic(){
    const seq = document.getElementById('sequenceBasic').value || '';
    const course = document.getElementById('courseNameBasic').value || '';
    const num = document.getElementById('numBasic').value || '';
    const url = document.getElementById('urlBasic').value || '';
    const explRaw = document.getElementById('explBasic').value || '';
    const corrRaw = document.getElementById('corrBasic').value || '';
    const trainersRaw = document.getElementById('trainersBasic').value || '';
    const othersRaw = document.getElementById('othersBasic').value || '';

    const expl = normalizeToMentions(explRaw);
    const corr = normalizeToMentions(corrRaw);
    const trainers = normalizeToMentions(trainersRaw);
    const others = normalizeToMentions(othersRaw);

    const sig = sigMap[course] || '<@571068478753341453>';

    const text = `*** نموذج الأنتهاء من الدورة واعتماد النتائج وطلب تسليم رول ***

\`- تم تعبية جداول رسوم الدورات في مجلد الخاص في دورة (${course}) رقم التسلسل (${seq}) قبل ارسال هاذا التقرير :\`

*** \` نوع الدورة : \`***  ***( أساسية )***

*** \` اسم الدورة : \`***  ***( ${course} )***

*** \` رقم الدورة : \`***   ***( ${num} )***

*** \`تم شرح الدورة من قبل  :\`***   ***( ${expl} )***

*** \`تم تصحيح الاختبار من قبل  :\`***  ***( ${corr} )***

*** \`المدربين المتفاعلين : \`***   ***( ${trainers} )***

*** \` باقي المدربين :\`***  ***( ${others} )***

*** \`نوع الطلب : \`***   اعطاء رول ***( ${course} )(${url})*** 

*** \` توقيع واعتماد :\` ${sig}***

*** \` للعلم :\` <@1182445629721563177>***

\`\`\`diff
- ملاحظه يتم ارفاق صوره الإداع المبلغ في الخزنه
\`\`\``;

    document.getElementById('outputBasic').value = text;
  }

  document.getElementById('createBasic').addEventListener('click', generateBasic);
  document.getElementById('copyBasic').addEventListener('click', ()=> {
    const txt = document.getElementById('outputBasic').value;
    if(!txt){ alert('لا يوجد نص لنسخه'); return; }
    navigator.clipboard.writeText(txt).then(()=> alert('تم النسخ'));
  });

  function generateSpecial(){
    const seq = document.getElementById('sequenceSpecial').value || '';
    const course = document.getElementById('courseNameSpecial').value || '';
    const techRaw = document.getElementById('techSpecial').value || '';
    const explRaw = document.getElementById('explSpecial').value || '';
    const grade = document.getElementById('gradeSpecial').value || '';

    const techMention = normalizeToMentions(techRaw);
    const explMention = normalizeToMentions(explRaw);

    let gradeLine = '';
    if(grade && grade !== 'لايوجد'){
      gradeLine = `*** \` درجة الاختبار : \`*** ${grade}\n\n`;
    }

    const sig = sigMap[course] || '<@571068478753341453>';

    const text = `*** نموذج الأنتهاء من الدورة الاستثنائية ***

\`- تم تعبية جداول رسوم الدورات في مجلد الدورة الاستثنائية في دورة (${course}) رقم التسلسل (${seq}) قبل ارسال هاذا التقرير :\`

*** \` اسم الدورة : \`*** ***( ${course} )***

*** \` تم إقامه الدورة للفني : \`*** ***${techMention}***

*** \`تم شرح الدورة من قبل  :\`***   ***${explMention}***

${gradeLine}*** \`نوع الطلب  :\`***   ***اعطاء رول ( ${course} ) 

*** \` توقيع واعتماد :\` ${sig} ***`;

    document.getElementById('outputSpecial').value = text;
  }

  document.getElementById('createSpecial').addEventListener('click', generateSpecial);
  document.getElementById('copySpecial').addEventListener('click', ()=> {
    const txt = document.getElementById('outputSpecial').value;
    if(!txt){ alert('لا يوجد نص لنسخه'); return; }
    navigator.clipboard.writeText(txt).then(()=> alert('تم النسخ'));
  });

  function formatMentionsVertical(input){
    if(!input) return '';
    const raw = input.trim();
    if(raw.toLowerCase() === 'لايوجد') return 'NO_FIELD';
    const parts = raw.split(/\s+/).map(p => {
      if(/^<@[^>]+>$/.test(p)) return p;
      if(/^@(.+)$/.test(p)) return `<@${p.replace(/^@/,'')}>`;
      if(/^[\dA-Za-z_-]+$/.test(p)) return `<@${p}>`;
      return p;
    });
    return parts.join('\n');
  }

  // العنوان الآن بالصيغة الدقيقة التي طلبتها: **`  اسم الدورة (  ) (رقم الدورة) `**
  function generateResults(){
    const course = document.getElementById('courseNameResults').value || '';
    const courseNum = (document.getElementById('resultsNum') && document.getElementById('resultsNum').value.trim()) || '';

    const titleCourse = course || '';

    const g10 = formatMentionsVertical(document.getElementById('grade10').value || '');
    const g9  = formatMentionsVertical(document.getElementById('grade9').value || '');
    const g8  = formatMentionsVertical(document.getElementById('grade8').value || '');
    const g7  = formatMentionsVertical(document.getElementById('grade7').value || '');

    const explRaw = document.getElementById('resultsExplainer').value || '';
    const respRaw = document.getElementById('resultsResponsible').value || '';
    const depRaw  = document.getElementById('resultsDeputy').value || '';

    const expl = explRaw ? normalizeToMentions(explRaw) : '( - )';
    const resp = respRaw ? respRaw.split(/\s+/).map(id => {
      if(/^<@[^>]+>$/.test(id)) return id;
      if(/^@(.+)$/.test(id)) return `<@${id.replace(/^@/,'')}>`;
      if(/^[\dA-Za-z_-]+$/.test(id)) return `<@${id}>`;
      return id;
    }).join(' ') : '( - )';
    const dep  = depRaw ? depRaw.split(/\s+/).map(id => {
      if(/^<@[^>]+>$/.test(id)) return id;
      if(/^@(.+)$/.test(id)) return `<@${id.replace(/^@/,'')}>`;
      if(/^[\dA-Za-z_-]+$/.test(id)) return `<@${id}>`;
      return id;
    }).join(' ') : '( - )';

    const signature = '<@1243196849372790916>';
    const copyTo = '<@&1071933354976493650>';
    const follow = '<@&1149742928953086105>';
    const info = '<@&1071933352497664010>';

    function block(label, data){
      if(!data || data === 'NO_FIELD') return '';
      return `${label}\n${data}\n\n`;
    }

    // هنا نركب السطر بالصيغة المطلوبة حرفياً: نجوم + باكتيك + مسافات كما طلبت
    // الناتج النهائي مثال: **`  اسم الدورة ( ورشة التصنيع ) (7) `**
    const titleLine = course
      ? '**`  اسم الدورة ( ' + titleCourse + ' ) ' + (courseNum ? '(' + courseNum + ')' : '') + ' `**'
      : '**`  اسم الدورة ( - ) `**';

    let text = `***﷽***

***اما بعد ..***

${titleLine}

${block('***10 / 10***', g10)}
${block('***10 / 09***', g9)}
${block('***10 / 08***', g8)}
${block('***10 / 07***', g7)}

-------------------------------------------------------------

***شرح :*** ${expl}

***مسؤول الدورة :*** ${resp}

***نائب مسؤول الدورة :*** ${dep}

***التوقيع واعتماد :*** ${signature}

***نسخة الى :*** ${copyTo}
***للمتابعة والتنفيذ :*** ${follow}
***للعلم والاحاطة :*** ${info}
`;

    document.getElementById('outputResults').value = text;
  }

  document.getElementById('createResults').addEventListener('click', generateResults);
  document.getElementById('copyResults').addEventListener('click', ()=> {
    const txt = document.getElementById('outputResults').value;
    if(!txt){ alert('لا يوجد نص لنسخه'); return; }
    navigator.clipboard.writeText(txt).then(()=> alert('تم النسخ'));
  });

  function selectType(which){
    document.getElementById('basicCard').style.display = (which === 'basic') ? 'block' : 'none';
    document.getElementById('specialCard').style.display = (which === 'special') ? 'block' : 'none';
    document.getElementById('resultsCard').style.display = (which === 'results') ? 'block' : 'none';
  }

  document.getElementById('typeSelect').addEventListener('change', function(){
    selectType(this.value);
  });

  document.querySelectorAll('.choice-btn').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      selectType(btn.dataset.select);
      document.getElementById('intro').style.display = 'none';
    });
  });

  document.getElementById('introClose').addEventListener('click', ()=>{
    document.getElementById('intro').style.display = 'none';
  });

  document.getElementById('sideBtn').addEventListener('click', function(e){
    const menu = document.getElementById('menu');
    menu.classList.toggle('open');
  });

  document.querySelectorAll('.menu-copy').forEach(btn=>{
    btn.addEventListener('click', function(e){
      e.stopPropagation();
      const url = btn.getAttribute('data-url') || '';
      if(!url){ alert('لا يوجد رابط للنسخ'); return; }
      navigator.clipboard.writeText(url).then(()=> {
        const original = btn.innerHTML;
        btn.innerHTML = 'تم النسخ';
        setTimeout(()=> btn.innerHTML = original, 1200);
      }).catch(()=> alert('فشل النسخ'));
    });
  });
</script>
</body>
</html>




